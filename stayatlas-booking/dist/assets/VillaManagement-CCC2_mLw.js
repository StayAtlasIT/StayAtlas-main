import{I as Y,j as e,J as Ne,X as ve,b as m,S as we,G as C,V as x}from"./index-CHayuJmP.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Ce=Y("play",ke);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Re=Y("upload",Se),Me=({modalOpen:h,editedVilla:d,closeModal:O,handleInputChange:u,handleAddressChange:y,handleAmenityChange:f,handleAddAmenity:S,handleRemoveAmenity:K,saveChanges:$,handleImageChange:j,handleAddImage:Q,handleRemoveImage:E,handleRoomChange:b,handleAddRoom:X,handleRemoveRoom:A,handleRealMomentChange:P,handleAddRealMoment:z,handleRemoveRealMoment:H,handleVideoUpload:D,videoUploads:J})=>{var V,T,I,w,U,F,L,R,p,g,q,W;if(!h||!d)return null;const _=(i,r)=>{const l=i.target.files[0];l&&D(l,r)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl max-h-[95vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Review Villa"}),e.jsx("button",{onClick:O,className:"text-gray-500 hover:text-gray-700 text-3xl font-bold",children:"×"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Villa Name"}),e.jsx("input",{type:"text",name:"villaName",value:d.villaName,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Owner Name"}),e.jsx("input",{type:"text",name:"villaOwner",value:d.villaOwner,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Property Type"}),e.jsx("input",{type:"text",name:"propertyType",value:d.propertyType,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Number of Rooms"}),e.jsx("input",{type:"text",name:"numberOfRooms",value:d.numberOfRooms,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Number of Bathrooms"}),e.jsx("input",{type:"number",name:"numberOfBathrooms",value:d.numberOfBathrooms||0,onChange:u,min:"0",placeholder:"Enter number of bathrooms",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Number of Bathrooms"}),e.jsx("input",{type:"number",name:"numberOfBathrooms",value:d.numberOfBathrooms||0,onChange:u,min:"0",placeholder:"Enter number of bathrooms",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Total Guest"}),e.jsx("input",{type:"number",name:"guestCapacity",value:d.guestCapacity||"",onChange:u,min:"1",placeholder:"Enter maximum guest capacity",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:d.email,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone Number"}),e.jsx("input",{type:"text",name:"phoneNumber",value:d.phoneNumber,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Address"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"street",placeholder:"Street",value:((V=d.address)==null?void 0:V.street)||"",onChange:y,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"landmark",placeholder:"Landmark",value:((T=d.address)==null?void 0:T.landmark)||"",onChange:y,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"city",placeholder:"City",value:((I=d.address)==null?void 0:I.city)||"",onChange:y,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"state",placeholder:"State",value:((w=d.address)==null?void 0:w.state)||"",onChange:y,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"country",placeholder:"Country",value:((U=d.address)==null?void 0:U.country)||"",onChange:y,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"zipcode",placeholder:"Zipcode",value:((F=d.address)==null?void 0:F.zipcode)||"",onChange:y,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Pricing"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Weekday Price (₹)"}),e.jsx("input",{type:"number",name:"weekdayPrice",value:((L=d.pricePerNightBoth)==null?void 0:L.weekday)||0,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Weekend Price (₹)"}),e.jsx("input",{type:"number",name:"weekendPrice",value:((R=d.pricePerNightBoth)==null?void 0:R.weekend)||0,onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount (%)"}),e.jsx("input",{type:"number",name:"discountPercent",value:d.discountPercent||0,onChange:u,min:"0",max:"100",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Promotion Text"}),e.jsx("textarea",{name:"promotionText",value:d.promotionText||"",onChange:u,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"isExclusive",checked:d.isExclusive,onChange:u,className:"mr-2 w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Exclusive Villa"})]})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Amenities"}),(p=d.amenities)==null?void 0:p.map((i,r)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:i,onChange:l=>f(r,l.target.value),className:"flex-1 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",placeholder:"Enter amenity"}),e.jsx("button",{onClick:()=>K(r),className:"bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600 transition",children:"Remove"})]},r)),e.jsx("button",{onClick:S,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Add Amenity"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Images"}),(g=d.images)==null?void 0:g.map((i,r)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"url",value:i,onChange:l=>j(r,l.target.value),placeholder:"Image URL",className:"flex-1 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("button",{onClick:()=>E(r),className:"bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600 transition",children:"Remove"})]},r)),e.jsx("button",{onClick:Q,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Add Image"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Real Moments"}),(q=d.realMoments)==null?void 0:q.map((i,r)=>{const l=`${d._id}-${r}`,N=J[l];return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Moment Name"}),e.jsx("input",{type:"text",name:"name",value:i.name,onChange:k=>P(k,r),placeholder:"Enter moment name",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:i.date,onChange:k=>P(k,r),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Video"}),i.video&&!N&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Current Video"})]}),e.jsx("video",{src:i.video,controls:!0,className:"w-full max-w-md h-40 object-cover rounded border"})]}),N&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-yellow-600 animate-spin"}),e.jsxs("span",{className:"text-sm text-yellow-800 font-medium",children:["Uploading... ",N.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-yellow-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-300",style:{width:`${N.progress}%`}})})]}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-blue-400 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Re,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:i.video?"Replace Video":"Upload Video"}),e.jsx("input",{type:"file",accept:"video/*",onChange:k=>_(k,r),className:"hidden",disabled:N==null?void 0:N.uploading}),e.jsx("span",{className:"mt-1 block text-sm text-gray-500",children:"MP4, AVI, MOV up to 100MB"})]})})]})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[e.jsx("p",{children:"• Supported formats: MP4, AVI, MOV, WMV"}),e.jsx("p",{children:"• Maximum file size: 100MB"}),e.jsx("p",{children:"• Recommended resolution: 1080p or higher"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{onClick:()=>H(r),className:"flex items-center gap-2 bg-red-500 text-white px-3 py-2 rounded text-sm hover:bg-red-600 transition",children:[e.jsx(ve,{className:"w-4 h-4"}),"Remove Moment"]})})]},r)}),e.jsx("button",{onClick:z,className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition",children:"Add Real Moment"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Rooms"}),(W=d.rooms)==null?void 0:W.map((i,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",name:"name",value:i.name,onChange:l=>b(l,r),placeholder:"Room name",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"floor",value:i.floor,onChange:l=>b(l,r),placeholder:"Floor",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"guests",value:i.guests,onChange:l=>b(l,r),placeholder:"Number of guests",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"equipped",value:i.equipped,onChange:l=>b(l,r),placeholder:"Equipment",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"bathroom",value:i.bathroom,onChange:l=>b(l,r),placeholder:"Bathroom details",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"}),e.jsx("input",{type:"text",name:"bedType",value:i.bedType,onChange:l=>b(l,r),placeholder:"Bed type",className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"})]}),e.jsx("input",{type:"url",name:"image",value:i.image,onChange:l=>b(l,r),placeholder:"Room image URL",className:"w-full border border-gray-300 rounded px-3 py-2 mt-2 focus:outline-none focus:border-blue-500"}),e.jsx("button",{onClick:()=>A(r),className:"bg-red-500 text-white px-3 py-2 rounded mt-2 hover:bg-red-600 transition",children:"Remove Room"})]},r)),e.jsx("button",{onClick:X,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Add Room"})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:O,className:"px-6 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Cancel"}),e.jsx("button",{onClick:$,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Save Changes"})]})]})]})})},Ae=()=>{const[h,d]=m.useState(0),O=h===0,[u,y]=m.useState([]),[f,S]=m.useState([]),[K,$]=m.useState(!1),[j,Q]=m.useState("all"),[E,b]=m.useState([]),[X,A]=m.useState(!1),[P,z]=m.useState(""),[H,D]=m.useState(null),[J,_]=m.useState({}),V=async s=>{try{const a=localStorage.getItem("adminToken"),o=await C.delete(`/v1/admin/villas/${s}`,{headers:{Authorization:`Bearer ${a}`}});console.log("Delete response:",o),x.success("Villa deleted successfully")}catch(a){console.error("Delete error:",a),x.error("Delete failed")}},T=s=>{D(s),A(!0)},I=async()=>{var s;try{const a=localStorage.getItem("adminToken"),t=(s=(await C.put(`/v1/admin/villas/${H}/reject`,{reason:P},{headers:{Authorization:`Bearer ${a}`}})).data)==null?void 0:s.data;x.success("Villa rejected successfully"),S(n=>n.filter(c=>c._id!==t._id)),g(n=>n.filter(c=>c._id!==t._id)),b(n=>[...n,t]),A(!1),z(""),D(null)}catch(a){x.error("Failed to reject villa"),console.error("Rejection Error:",a)}},w=({villa:s,isManage:a})=>{const[o,t]=m.useState(!1);return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:s.villaName}),e.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:s.propertyType})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Owner"}),e.jsx("p",{className:"font-medium",children:s==null?void 0:s.villaOwner})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Contact"}),e.jsx("p",{className:"font-medium",children:s.email}),e.jsx("p",{className:"font-medium",children:s.phoneNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Rooms"}),e.jsx("p",{className:"font-medium",children:s.numberOfRooms})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Max Guests"}),e.jsx("p",{className:"font-medium",children:s.guestCapacity||s.numberOfRooms*2})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Villa Type"}),e.jsx("p",{className:"text-md font-semibold",children:s.isExclusive?"Exclusive":"Explore"})]})]}),e.jsxs("button",{onClick:()=>t(!o),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center mb-2",children:[o?"Show less":"Show more",e.jsx("svg",{className:`w-4 h-4 ml-1 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),o&&e.jsxs("div",{className:"mt-4 space-y-4 border-t pt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:"Address"}),e.jsxs("div",{className:"pl-2 border-l-2 border-gray-200",children:[e.jsx("p",{children:s==null?void 0:s.address.street}),e.jsx("p",{children:s==null?void 0:s.address.landmark}),e.jsxs("p",{children:[s==null?void 0:s.address.city,", ",s==null?void 0:s.address.state]}),e.jsxs("p",{children:[s==null?void 0:s.address.country,", ",s==null?void 0:s.address.zipcode]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.amenities.map((n,c)=>e.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm",children:n},c))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-700",children:s.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:"Photos"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.images.map((n,c)=>e.jsx("img",{src:n,alt:`${s.villaName} photo ${c+1}`,className:"w-full h-32 object-cover rounded"},c))})]}),s.realMoments&&s.realMoments.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:"Real Moments"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.realMoments.map((n,c)=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:n.name}),e.jsx("span",{className:"text-xs text-gray-500",children:n.date})]}),n.video&&e.jsx("video",{src:n.video,controls:!0,playsInline:!0,preload:"metadata",style:{width:"100%",height:"auto"}})]},c))})]})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex gap-3",children:[e.jsx("button",{onClick:()=>N(s,s._id),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:a?"Review":"Edit"}),!a&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>V(s._id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Delete"}),e.jsx("button",{onClick:()=>T(s._id),className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition",children:"Reject"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>V(s._id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Delete"}),e.jsx("button",{onClick:()=>T(s._id),className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition",children:"Reject"})]})]})]})};m.useEffect(()=>{async function s(){try{const[a,o]=await Promise.all([C.get("/v1/admin/get-all-pending-villa"),C.get("/v1/admin/get-all-approved-villa")]);if(a.data.statusCode==200){const t=Array.isArray(a.data.data.villas)?a.data.data.villas:[];y(t),R(t)}else x.error("Error fetching pending villas"),console.error("Error fetching pending villas:",a.data.message);if(o.data.statusCode==200){const t=Array.isArray(o.data.data.villas)?o.data.data.villas:[];S(t),g(t)}else x.error("Error fetching approved villas"),console.error("Error fetching approved villas:",o.data.message)}catch(a){x.error("Error fetching villa data"),console.error("Error fetching data:",a)}}s()},[K]);const[U,F]=m.useState(""),[L,R]=m.useState(u),[p,g]=m.useState(f),q=s=>{const a=s.target.value.toLowerCase();if(F(a),h==0){const o=u.filter(t=>t.phoneNumber.toLowerCase().includes(a));R(o)}else{const o=f.filter(t=>t.phoneNumber.toLowerCase().includes(a)||t.villaOwner.toLowerCase().includes(a)||t.villaName.toLowerCase().includes(a));g(o)}},[W,i]=m.useState(!1),[r,l]=m.useState(),N=(s,a)=>{var o,t,n,c,B,M,v,G;l({_id:a||"",villaOwner:s.villaOwner||"",villaName:s.villaName||"",propertyType:s.propertyType||"",numberOfRooms:s.numberOfRooms||"",numberOfBathrooms:s.numberOfBathrooms||0,guestCapacity:s.guestCapacity||""(s.numberOfRooms?s.numberOfRooms*2:0),email:s.email||"",phoneNumber:s.phoneNumber||"",address:{street:((o=s.address)==null?void 0:o.street)||"",landmark:((t=s.address)==null?void 0:t.landmark)||"",city:((n=s.address)==null?void 0:n.city)||"",state:((c=s.address)==null?void 0:c.state)||"",country:((B=s.address)==null?void 0:B.country)||"",zipcode:((M=s.address)==null?void 0:M.zipcode)||""},amenities:Array.isArray(s.amenities)?s.amenities:[],images:Array.isArray(s.images)?s.images:[],category:Array.isArray(s.category)?s.category:[],availability:Array.isArray(s.availability)?s.availability:[],pricePerNightBoth:{weekday:((v=s.pricePerNightBoth)==null?void 0:v.weekday)||1,weekend:((G=s.pricePerNightBoth)==null?void 0:G.weekend)||1,setBy:"admin",currency:"INR"},discountPercent:s.discountPercent||0,promotionText:s.promotionText||"",isExclusive:s.isExclusive||!1,approvalStatus:s.approvalStatus||"approved",approvalComment:s.approvalComment||"",realMoments:Array.isArray(s.realMoments)?s.realMoments:[],rooms:Array.isArray(s.rooms)?s.rooms:[]}),i(!0)},k=s=>{const{name:a,value:o}=s.target;if(a==="isExclusive"){l(t=>({...t,[a]:s.target.checked}));return}else if(a==="weekdayPrice"||a==="weekendPrice"){const t=o.replace(/[^0-9]/g,"");l(n=>({...n,pricePerNightBoth:{...n.pricePerNightBoth,[a==="weekdayPrice"?"weekday":"weekend"]:Number(t||0)}}))}else l(a==="guestCapacity"?t=>({...t,[a]:Number(o)||0}):t=>({...t,[a]:o}))},ee=s=>{const{name:a,value:o}=s.target;l(t=>({...t,address:{...t.address,[a]:o}}))},se=(s,a)=>{const o=[...r.amenities];o[s]=a,l(t=>({...t,amenities:o}))},re=()=>{l(s=>({...s,amenities:[...s.amenities,""]}))},te=s=>{const a=[...r.amenities];a.splice(s,1),l(o=>({...o,amenities:a}))},ae=(s,a)=>{const o=[...r.images];o[s]=a,l(t=>({...t,images:o}))},oe=()=>{l(s=>({...s,images:[...s.images,""]}))},ne=s=>{const a=r.images.filter((o,t)=>t!==s);l(o=>({...o,images:a}))},le=(s,a)=>{const o=[...r.rooms];o[a][s.target.name]=s.target.value,l(t=>({...t,rooms:o}))},de=()=>{const s={name:"",floor:"",guests:"",equipped:"",bathroom:"",image:"",bedType:""};l(a=>({...a,rooms:[...a.rooms||[],s]}))},ie=s=>{const a=r.rooms.filter((o,t)=>t!==s);l(o=>({...o,rooms:a}))},ce=(s,a)=>{var n;const o=(n=s.target.files)==null?void 0:n[0];if(!o)return;if(!o.type.startsWith("video/")){x.error("Please select a valid video file");return}const t=100*1024*1024;if(o.size>t){x.error("Video file must be less than 100MB");return}Z(o,a)},Z=async(s,a)=>{const o=`${r._id}-${a}`,t=localStorage.getItem("adminToken");try{_(v=>({...v,[o]:{uploading:!0,progress:0}}));const n=new FormData;n.append("video",s),n.append("villaId",r._id),n.append("momentIndex",a.toString());const c=await C.post("/v1/admin/upload-real-moment-video",n,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${t}`},onUploadProgress:v=>{const G=Math.round(v.loaded*100/v.total);_(je=>({...je,[o]:{uploading:!0,progress:G}}))}}),B=c.data.videoUrl||c.data.url;if(!B)throw new Error(c.data.message||"Upload failed");const M=[...r.realMoments];M[a]={...M[a],video:B},l(v=>({...v,realMoments:M})),x.success(c.data.message||"Video uploaded successfully")}catch(n){console.error("Video upload error:",n),x.error(n.message||"Failed to upload video")}finally{_(n=>{const c={...n};return delete c[o],c})}},me=()=>{const s={video:"",name:"",date:""};l(a=>({...a,realMoments:[...a.realMoments||[],s]}))},ue=s=>{const a=r.realMoments.filter((o,t)=>t!==s);l(o=>({...o,realMoments:a}))},xe=async()=>{try{r.numberOfRooms=String(r.numberOfRooms),r.discountPercent=Number(r.discountPercent||0),r.pricePerNightBoth.weekday=Number(r.pricePerNightBoth.weekday||1),r.pricePerNightBoth.weekend=Number(r.pricePerNightBoth.weekend||1),r.address.street=String(r.address.street||""),r.address.landmark=String(r.address.landmark||""),r.address.city=String(r.address.city||""),r.address.state=String(r.address.state||""),r.address.country=String(r.address.country||""),r.address.zipcode=String(r.address.zipcode||""),r.images=r.images.map(String),r.amenities=r.amenities.map(String),r.propertyType=String(r.propertyType),r.category=r.category.map(String),r.isExclusive=r.isExclusive===!0||r.isExclusive==="true"||r.isExclusive===1,r.rooms=Array.isArray(r.rooms)?r.rooms.map(t=>({name:String(t.name||""),floor:String(t.floor||""),guests:String(t.guests||""),equipped:String(t.equipped||""),bathroom:String(t.bathroom||""),image:String(t.image||""),bedType:String(t.bedType||"")})):[],r.realMoments=Array.isArray(r.realMoments)?r.realMoments.map(t=>({video:String(t.video||""),name:String(t.name||""),date:String(t.date||"")})):[],O&&(r.approvalStatus="pending"),r.approvalStatus=String(r.approvalStatus);const s=r.approvalStatus==="pending",a=s?`/v1/admin/approve-pending-villa/${r._id}`:`/v1/admin/edit-villaById/${r._id}`,o=await C.post(a,r);o.data.statusCode===200?(x.success(s?"Villa approved":"Villa updated"),s?(y(t=>t.filter(n=>n._id!==r._id)),R(t=>t.filter(n=>n._id!==r._id)),S(t=>[...t,o.data.data]),g(t=>[...t,o.data.data])):(S(t=>t.map(n=>n._id===r._id?o.data.data:n)),g(t=>t.map(n=>n._id===r._id?o.data.data:n))),$(!0)):x.error("Failed to save changes"),i(!1)}catch(s){x.error("Error saving changes"),console.error("Save error:",s)}$(!0),i(!1)},pe=()=>{i(!1)};m.useEffect(()=>{(async()=>{var a,o;try{const n=((o=(a=(await C.get("/v1/admin/get-all-rejected-villa")).data)==null?void 0:a.data)==null?void 0:o.villas)||[];b(n)}catch(t){console.error("Failed to fetch rejected villas:",t)}})()},[]),m.useEffect(()=>{g(j==="rejected"?E:f)},[j,f,E]);const be=f.length,ge=f.filter(s=>s.isExclusive).length,he=f.filter(s=>!s.isExclusive&&s.approvalStatus==="approved").length,ye=E.length,fe=[{key:"all",label:"All",count:be},{key:"exclusive",label:"Exclusive",count:ge},{key:"explore",label:"Explore",count:he},{key:"rejected",label:"Rejected",count:ye}];return e.jsxs("div",{className:"w-full overflow-hidden min-h-screen bg-gray-100 p-4",children:[e.jsx("div",{className:"mb-10 text-center",children:e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-green-700 tracking-tight",children:"Villa Management"})}),e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("button",{onClick:()=>d(0),className:`px-4 py-2 rounded-md transition ${h===0?"bg-blue-600 text-white":"bg-gray-300 hover:bg-gray-400"}`,children:"Manage Villas"}),e.jsx("button",{onClick:()=>d(1),className:`px-4 py-2 rounded-md transition ${h===1?"bg-blue-600 text-white":"bg-gray-300 hover:bg-gray-400"}`,children:"View Villas"})]}),e.jsxs("div",{className:"flex items-center border border-gray-400 rounded-md px-2 w-1/3 focus-within:border-blue-500 focus-within:border-2",children:[e.jsx(we,{className:"text-gray-500 mr-2"}),e.jsx("input",{type:"text",placeholder:"Search by villa name, mobile number or owner name",value:U,onChange:q,className:"py-2 outline-none w-full"})]})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${h*100}%)`},children:[u.length===0&&h===0?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100 min-w-full",children:e.jsx("p",{className:"text-lg text-gray-500",children:"No pending villas to manage."})}):e.jsx("div",{className:"min-w-full grid gap-6",children:L.map(s=>e.jsx(w,{villa:s,isManage:!0},s._id))}),h===1&&e.jsxs("div",{className:"min-w-full flex flex-col gap-6",children:[e.jsx("div",{className:"flex justify-center gap-4 mb-4 flex-wrap",children:fe.map(({key:s,label:a,count:o})=>e.jsxs("button",{onClick:()=>Q(s),className:`px-4 py-2 rounded-md transition capitalize ${j===s?"bg-blue-600 text-white":"bg-gray-300 hover:bg-gray-400"}`,children:[a," (",o,")"]},s))}),e.jsxs("div",{className:"min-w-full grid gap-6",children:[j==="all"&&(p.length>0?p.map(s=>e.jsx(w,{villa:s,isManage:!1},s._id)):e.jsx("p",{className:"text-gray-500",children:"No villas to show."})),j==="exclusive"&&(p.filter(s=>s.isExclusive).length>0?p.filter(s=>s.isExclusive).map(s=>e.jsx(w,{villa:s,isManage:!1},s._id)):e.jsx("p",{className:"text-gray-500",children:"No exclusive villas."})),j==="explore"&&(p.filter(s=>!s.isExclusive).length>0?p.filter(s=>!s.isExclusive).map(s=>e.jsx(w,{villa:s,isManage:!1},s._id)):e.jsx("p",{className:"text-gray-500",children:"No explore villas."})),j==="rejected"&&(p.length>0?p.map(s=>e.jsx(w,{villa:s,isManage:!1},s._id)):e.jsx("p",{className:"text-gray-500",children:"No rejected villas."}))]})]})]}),X&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl w-[400px]",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Reject Villa"}),e.jsx("textarea",{className:"w-full border border-gray-300 p-2 rounded",rows:"4",placeholder:"Enter reason",value:P,onChange:s=>z(s.target.value)}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx("button",{onClick:()=>A(!1),className:"text-gray-600",children:"Cancel"}),e.jsx("button",{onClick:I,className:"bg-red-600 text-white px-4 py-2 rounded",children:"Reject"})]})]})})]}),e.jsx(Me,{modalOpen:W,editedVilla:r,closeModal:pe,handleInputChange:k,handleAddressChange:ee,handleAmenityChange:se,handleAddAmenity:re,handleRemoveAmenity:te,saveChanges:xe,handleImageChange:ae,handleAddImage:oe,handleRemoveImage:ne,handleRoomChange:le,handleAddRoom:de,handleRemoveRoom:ie,handleRealMomentChange:ce,handleAddRealMoment:me,handleRemoveRealMoment:ue,handleVideoUpload:Z,videoUploads:J})]})};export{Ae as default};
